{"version":3,"sources":["simulation.js","ui.js"],"names":["SirSimulation","running","rate","cs","range","color","idToI","vacc","beta","gamma","interval","callback","current_inf","total_inf","day","init","counties","max_pop","d3","scale","pow","exponent","domain","init_cs","start","cid","n","c","get","inf","sus","rec","setInterval","update","that","i","length","da","db","step","flush","max","Math","pop","total_infected","total","self","map","set","id","reset","clearInterval","County","simulation","coms","d","rgb","r","b","g","toString","select","style","com","ci","work_id","dx","width","height","active_state","active_counties","projection","geo","albersUsa","translate","path","svg","append","attr","popById","commutes","active_commutes","queue","defer","json","tsv","population","await","ready","error","us","commuter_data","onchage","selectAll","data","topojson","feature","objects","features","enter","on","parentNode","appendChild","classed","county_clicked","states","state_clicked","node","state_id","floor","undefined","filter","home_id","each","push","r_nought","document","getElementById","value","D","onchange","bounds","dy","x","y","transition","duration","c_inf","t_inf","innerHTML","toLocaleString","round","frameElement"],"mappings":"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","file":"ui.69528adb.js","sourceRoot":"..","sourcesContent":["export function SirSimulation() {\n  this.running = false;\n  this.rate = 10;\n\n  this.cs;\n  this.range;\n  this.color;\n  this.idToI;\n\n  this.vacc;\n  this.beta;\n  this.gamma;\n\n  this.interval;\n\n  this.callback;\n  this.current_inf;\n  this.total_inf;\n  this.day = 1;\n\n  this.init = function(counties, beta, gamma, vacc, callback) {\n    this.cs = counties;\n    this.beta = beta / this.rate;\n    this.gamma = gamma / this.rate;\n    this.vacc = vacc;\n    this.callback = callback;\n    this.range = [0, this.max_pop()];\n    this.color = d3.scale\n      .pow()\n      .exponent(0.33)\n      .domain(this.range)\n      .range([\"#ffffff\", \"#08306b\"]);\n    this.init_cs();\n  };\n\n  this.start = function(cid, n) {\n    this.running = true;\n    const c = this.cs[this.idToI.get(cid)];\n    c.inf += n;\n    if (c.sus >= n) {\n      c.sus -= n;\n    } else {\n      c.rec -= n;\n    }\n    this.current_inf = n;\n    this.total_inf = n;\n    this.day = 0;\n    this.interval = setInterval(this.update, 1000 / this.rate, this);\n    this.update(this);\n  };\n\n  this.update = that => {\n    that.callback(that.current_inf, that.total_inf, that.day / that.rate);\n    let c;\n    for (var i = 0; i < that.cs.length; i++) {\n      c = that.cs[i];\n      c.da = 0;\n      c.db = 0;\n    }\n    for (var i = 0; i < that.cs.length; i++) {\n      c = that.cs[i];\n      if (c.inf > 0) {\n        c.step();\n      }\n    }\n    for (var i = 0; i < that.cs.length; i++) {\n      that.cs[i].flush();\n    }\n\n    that.day = that.day + 1;\n  };\n\n  this.max_pop = function() {\n    let max = 0;\n    for (let i = 0; i < this.cs.length; i++) {\n      max = Math.max(this.cs[i].pop, max);\n    }\n    return max;\n  };\n\n  this.total_infected = function() {\n    let total = 0;\n    for (let i = 0; i < this.cs.length; i++) {\n      total += this.cs[i].inf;\n    }\n    return total;\n  };\n\n  const self = this;\n\n  this.init_cs = function() {\n    this.idToI = d3.map();\n    let c;\n    for (let i = 0; i < this.cs.length; i++) {\n      c = this.cs[i];\n      this.idToI.set(c.id, i);\n      c.rec = c.pop * self.vacc;\n      c.sus = c.pop - c.rec;\n      c.inf = 0;\n      c.init();\n    }\n  };\n\n  this.reset = function() {\n    clearInterval(this.interval);\n    this.callback(0, 0, 0);\n    this.running = false;\n  };\n}\n\nexport function County(simulation, i, id, pop, coms) {\n  this.i = i;\n  this.id = id;\n  this.pop = pop;\n  this.coms = coms;\n\n  this.color;\n\n  this.sus;\n  this.inf;\n  this.rec;\n\n  this.da;\n  this.db;\n\n  this.init = function() {\n    const c = simulation.color(this.pop);\n    const d = d3.rgb(c);\n    d.r = d.b;\n    d.g = d.b;\n    d.b = 0;\n    this.color = d3.scale\n      .pow()\n      .exponent(0.2)\n      .domain([0, 1])\n      .range([c, d.toString()]);\n    d3.select(`#s${this.id}`).style(\"fill\", c);\n  };\n\n  this.step = function() {\n    for (let i = 0; i < this.coms.length; i++) {\n      const com = this.coms[i];\n      const ci = simulation.idToI.get(+com.work_id);\n      const c = simulation.cs[ci];\n      const n = +com.total;\n      const dx = simulation.beta * this.inf * (n / this.pop) * (c.sus / c.pop);\n      c.da += dx;\n    }\n    this.da += simulation.beta * this.inf * (this.sus / this.pop);\n    this.db += simulation.gamma * this.inf;\n  };\n\n  this.flush = function() {\n    this.sus += -this.da;\n    this.inf += this.da - this.db;\n    this.rec += this.db;\n\n    simulation.total_inf += this.da;\n    simulation.current_inf += this.da - this.db;\n\n    d3.select(`#s${this.id}`).style(\"fill\", this.color(this.inf / this.pop));\n  };\n}\n\n","import { County, SirSimulation } from './simulation.js';\n\n      const simulation = new SirSimulation();\n\n      var width = 960,\n          height = 600;\n\n      /* d3 selectors with active elements when a state is selected */\n      var active_state = d3.select(null),\n          active_counties = d3.select(null);\n\n      /* standard US projection */\n      var projection = d3.geo.albersUsa()\n          .scale(1280)\n          .translate([width / 2, height / 2]);\n\n      /* path used to draw all geometric elements */\n      var path = d3.geo.path()\n          .projection(projection);\n\n      /* create a new svg element */\n      var svg = d3.select(\"#vis\").append(\"svg\")\n          .attr(\"width\", width)\n          .attr(\"height\", height);\n\n      /* chrome cannot handle svg transforms, so svg is really a nested g tag */\n      svg = svg.append(\"g\");\n\n      /* map for converting county id (fips) to population */\n      var popById = d3.map();\n\n      /* array of commutes */\n      var commutes = [],\n          active_commutes = [];\n\n      /* wait for files to load and update popById */\n      queue()\n          .defer(d3.json, \"data/us.json\")\n          .defer(d3.tsv, \"data/commuter.tsv\")\n          .defer(d3.tsv, \"data/population.tsv\", function (d) { popById.set(d.id, +d.population); })\n          .await(ready);\n\n      function ready(error, us, commuter_data, onchage) {\n        if (error) throw error;\n\n        commutes = commuter_data;\n\n        /* draw all counties */\n        svg.append(\"g\")\n          .attr(\"class\", \"counties\")\n          .selectAll(\"path\")\n            .data(topojson.feature(us, us.objects.counties).features)\n          .enter().append(\"path\")\n            .attr(\"d\", path)\n            .attr(\"class\", \"county\")\n            .attr(\"id\", function (d) { return \"s\" + d.id; })\n            .on(\"mouseover\", function () {\n              this.parentNode.appendChild(this);\n              d3.select(this)\n                .classed(\"hovered\", true);\n            })\n            .on(\"mouseout\", function () {\n              d3.select(this)\n                .classed(\"hovered\", false);\n            })\n            .on(\"click\", county_clicked);\n\n        /* draw all states */\n        svg.append(\"g\")\n          .attr(\"class\", \"states\")\n          .selectAll(\"path\")\n            .data(topojson.feature(us, us.objects.states).features)\n          .enter().append(\"path\")\n            .attr(\"d\", path)\n            .attr(\"class\", \"state\")\n            .on(\"click\", state_clicked);\n      }\n\n      function state_clicked(d) {\n        if (active_state.node() != null && active_state.node() != this) return reset();\n\n        /* remove old active states and counties */\n        active_state.classed(\"active\", false);\n        active_counties.classed(\"active\", false);\n\n        /* make the clicked state active */\n        active_state = d3.select(this).classed(\"active\", true);\n\n        /* make the state's counties active */\n        var state_id = d.id;\n        active_counties = svg.select(\"g.counties\")\n                            .selectAll(\"path.county\")\n                              .classed(\"active\", function (d) { return Math.floor(d.id/1000) == state_id && popById.get(d.id) !== undefined; });\n        active_counties = active_counties.filter(\".active\");\n\n        /* get all relevant commutes */\n        active_commutes = commutes.filter(function (d) {\n          var id = +d.home_id;\n          return Math.floor(id / 1000) == state_id && popById.get(id) !== undefined;\n        });\n\n        /* initialize the simulation */\n        var counties = [];\n        active_counties.each(function (d, i) {\n          counties.push(new County(simulation, i, d.id, popById.get(d.id), active_commutes.filter(function (c) { return +c.home_id == d.id; })));\n        });\n        var r_nought = document.getElementById(\"reproduction\").value;\n        var D = document.getElementById(\"duration\").value;\n        var vacc = document.getElementById(\"vacc\").value / 100;\n        simulation.init(counties, r_nought*(1/D), 1/D, vacc, onchange);\n\n        /* get bounds of state */\n        var bounds = path.bounds(d),\n            dx = bounds[1][0] - bounds[0][0],\n            dy = bounds[1][1] - bounds[0][1],\n            x = (bounds[0][0] + bounds[1][0]) / 2,\n            y = (bounds[0][1] + bounds[1][1]) / 2,\n            scale = .9 / Math.max(dx / width, dy / height),\n            translate = [width / 2 - scale * x, height / 2 - scale * y];\n\n        /* transition svg to fit bounds of state */\n        svg.transition()\n            .duration(750)\n            .style(\"stroke-width\", 1.5 / scale + \"px\")\n            .attr(\"transform\", \"translate(\" + translate + \")scale(\" + scale + \")\");\n      }\n\n      function county_clicked(d) {\n        if (!simulation.running) {\n          var n = Math.floor(document.getElementById(\"infected\").value);\n          simulation.start(d.id, n);\n        }\n      }\n\n      function reset() {\n        simulation.reset();\n\n        active_state.classed(\"active\", false);\n        active_state = d3.select(null);\n\n        active_counties.classed(\"active\", false);\n        active_counties = d3.select(null);\n\n        svg.transition()\n            .duration(750)\n            .style(\"stroke-width\", \"1.5px\")\n            .attr(\"transform\", \"\");\n      }\n\n      function onchange(c_inf, t_inf, day) {\n        document.getElementById(\"sim_day\").innerHTML = Math.floor(day).toLocaleString();\n        document.getElementById(\"c_inf\").innerHTML = Math.round(c_inf).toLocaleString();\n        document.getElementById(\"t_inf\").innerHTML = Math.round(t_inf).toLocaleString();\n      }\n\n      d3.select(self.frameElement).style(\"height\", height + \"px\");"]}