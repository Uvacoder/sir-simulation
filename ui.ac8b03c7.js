parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"4dRf":[function(require,module,exports) {
"use strict";function t(){this.running=!1,this.rate=10,this.cs,this.range,this.color,this.idToI,this.vacc,this.beta,this.gamma,this.interval,this.callback,this.current_inf,this.total_inf,this.day=1,this.init=function(t,i,s,h,n){this.cs=t,this.beta=i/this.rate,this.gamma=s/this.rate,this.vacc=h,this.callback=n,this.range=[0,this.max_pop()],this.color=d3.scale.pow().exponent(.33).domain(this.range).range(["#ffffff","#08306b"]),this.init_cs()},this.start=function(t,i){this.running=!0;var s=this.cs[this.idToI.get(t)];s.inf+=i,s.sus>=i?s.sus-=i:s.rec-=i,this.current_inf=i,this.total_inf=i,this.day=0,this.interval=setInterval(this.update,1e3/this.rate,this),this.update(this)},this.update=function(t){var i;t.callback(t.current_inf,t.total_inf,t.day/t.rate);for(var s=0;s<t.cs.length;s++)(i=t.cs[s]).da=0,i.db=0;for(s=0;s<t.cs.length;s++)(i=t.cs[s]).inf>0&&i.step();for(s=0;s<t.cs.length;s++)t.cs[s].flush();t.day=t.day+1},this.max_pop=function(){for(var t=0,i=0;i<this.cs.length;i++)t=Math.max(this.cs[i].pop,t);return t},this.total_infected=function(){for(var t=0,i=0;i<this.cs.length;i++)t+=this.cs[i].inf;return t};var t=this;this.init_cs=function(){var i;this.idToI=d3.map();for(var s=0;s<this.cs.length;s++)i=this.cs[s],this.idToI.set(i.id,s),i.rec=i.pop*t.vacc,i.sus=i.pop-i.rec,i.inf=0,i.init()},this.reset=function(){clearInterval(this.interval),this.callback(0,0,0),this.running=!1}}function i(t,i,s,h,n){this.i=i,this.id=s,this.pop=h,this.coms=n,this.color,this.sus,this.inf,this.rec,this.da,this.db,this.init=function(){var i=t.color(this.pop),s=d3.rgb(i);s.r=s.b,s.g=s.b,s.b=0,this.color=d3.scale.pow().exponent(.2).domain([0,1]).range([i,s.toString()]),d3.select("#s".concat(this.id)).style("fill",i)},this.step=function(){for(var i=0;i<this.coms.length;i++){var s=this.coms[i],h=t.idToI.get(+s.work_id),n=t.cs[h],a=+s.total,e=t.beta*this.inf*(a/this.pop)*(n.sus/n.pop);n.da+=e}this.da+=t.beta*this.inf*(this.sus/this.pop),this.db+=t.gamma*this.inf},this.flush=function(){this.sus+=-this.da,this.inf+=this.da-this.db,this.rec+=this.db,t.total_inf+=this.da,t.current_inf+=this.da-this.db,d3.select("#s".concat(this.id)).style("fill",this.color(this.inf/this.pop))}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SirSimulation=t,exports.County=i;
},{}],"lA8h":[function(require,module,exports) {
"use strict";var t=require("./simulation.js"),e=new t.SirSimulation,n=960,a=600,s=d3.select(null),o=d3.select(null),i=d3.geo.albersUsa().scale(1280).translate([n/2,a/2]),d=d3.geo.path().projection(i),r=d3.select("#vis").append("svg").attr("width",n).attr("height",a);r=r.append("g");var l=d3.map(),c=[],u=[];function f(t,e,n,a){if(t)throw t;c=n,r.append("g").attr("class","counties").selectAll("path").data(topojson.feature(e,e.objects.counties).features).enter().append("path").attr("d",d).attr("class","county").attr("id",function(t){return"s"+t.id}).on("mouseover",function(){this.parentNode.appendChild(this),d3.select(this).classed("hovered",!0)}).on("mouseout",function(){d3.select(this).classed("hovered",!1)}).on("click",p),r.append("g").attr("class","states").selectAll("path").data(topojson.feature(e,e.objects.states).features).enter().append("path").attr("d",d).attr("class","state").on("click",h)}function h(i){if(null!=s.node()&&s.node()!=this)return v();s.classed("active",!1),o.classed("active",!1),s=d3.select(this).classed("active",!0);var f=i.id;o=(o=r.select("g.counties").selectAll("path.county").classed("active",function(t){return Math.floor(t.id/1e3)==f&&void 0!==l.get(t.id)})).filter(".active"),u=c.filter(function(t){var e=+t.home_id;return Math.floor(e/1e3)==f&&void 0!==l.get(e)});var h=[];o.each(function(n,a){h.push(new t.County(e,a,n.id,l.get(n.id),u.filter(function(t){return+t.home_id==n.id})))});var p=document.getElementById("reproduction").value,g=document.getElementById("duration").value,y=document.getElementById("vacc").value/100;e.init(h,p*(1/g),1/g,y,m);var M=d.bounds(i),j=M[1][0]-M[0][0],E=M[1][1]-M[0][1],w=(M[0][0]+M[1][0])/2,B=(M[0][1]+M[1][1])/2,I=.9/Math.max(j/n,E/a),L=[n/2-I*w,a/2-I*B];r.transition().duration(750).style("stroke-width",1.5/I+"px").attr("transform","translate("+L+")scale("+I+")")}function p(t){if(!e.running){var n=Math.floor(document.getElementById("infected").value);e.start(t.id,n)}}function v(){e.reset(),s.classed("active",!1),s=d3.select(null),o.classed("active",!1),o=d3.select(null),r.transition().duration(750).style("stroke-width","1.5px").attr("transform","")}function m(t,e,n){document.getElementById("sim_day").innerHTML=Math.floor(n).toLocaleString(),document.getElementById("c_inf").innerHTML=Math.round(t).toLocaleString(),document.getElementById("t_inf").innerHTML=Math.round(e).toLocaleString()}queue().defer(d3.json,"data/us.json").defer(d3.tsv,"data/commuter.tsv").defer(d3.tsv,"data/population.tsv",function(t){l.set(t.id,+t.population)}).await(f),d3.select(self.frameElement).style("height",a+"px");
},{"./simulation.js":"4dRf"}]},{},["lA8h"], null)
//# sourceMappingURL=/sir-simulation/ui.ac8b03c7.js.map